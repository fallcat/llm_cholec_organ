Evaluating claude-sonnet-4-20250514 Pointing
==========================================
Evaluation Configuration
==========================================
Number of samples: 100
Models: claude-sonnet-4-20250514
Cell selection: SKIPPED
Pointing: ENABLED
Persistent directories: true
API caching: false

==========================================
Pointing Evaluation
==========================================
Output: ../results/pointing_original/

✓ Environment setup complete

============================================================
Pointing Evaluation Configuration (Original Image Size)
============================================================
Samples: 100
Models: claude-sonnet-4-20250514
Cache: disabled
Enhanced metrics: enabled
Skip zero-shot: False
Skip few-shot: False

To customize, either:
1. In notebooks: Call main() directly with parameters
2. Set environment variables before running:
   export EVAL_NUM_SAMPLES=10
   export EVAL_MODELS='gpt-5-mini,claude-sonnet-4-20250514'
   export EVAL_USE_CACHE=false  # to disable cache
   export EVAL_USE_ENHANCED=false  # to disable enhanced metrics
   export EVAL_SKIP_ZERO_SHOT=true  # to skip zero-shot
   export EVAL_SKIP_FEW_SHOT=true  # to skip few-shot
   export EVAL_QUICK_TEST=true
3. Or run inline: EVAL_SKIP_ZERO_SHOT=true python3 eval_pointing_original_size.py
============================================================


============================================================
Starting Pointing Evaluation (Original Image Size)
============================================================
Models to evaluate: claude-sonnet-4-20250514

📊 Loading CholecSeg8k dataset...
✓ Dataset loaded
✓ Using original image dimensions: 854x480
✓ Loaded 100 test samples
✓ Loaded few-shot plan: standard
✓ Loaded few-shot plan: hard_negatives
✓ Using persistent directory: ../results/pointing_original
Initialized evaluator:
  Models: ['claude-sonnet-4-20250514']
  Organs: 12
  Canvas: 854x480
  Output: ../results/pointing_original

📊 Evaluating 100 test samples with enhanced metrics

============================================================
Evaluating: claude-sonnet-4-20250514
============================================================

🔄 Running zero-shot with claude-sonnet-4-20250514 (enhanced metrics)...
claude-sonnet-4-20250514 zero-shot:   0%|          | 0/100 [00:00<?, ?it/s]claude-sonnet-4-20250514 zero-shot:   1%|          | 1/100 [00:22<37:40, 22.83s/it]claude-sonnet-4-20250514 zero-shot:   2%|▏         | 2/100 [00:48<39:40, 24.30s/it]claude-sonnet-4-20250514 zero-shot:   3%|▎         | 3/100 [01:12<39:37, 24.51s/it]claude-sonnet-4-20250514 zero-shot:   4%|▍         | 4/100 [01:35<38:00, 23.75s/it]claude-sonnet-4-20250514 zero-shot:   5%|▌         | 5/100 [01:57<36:34, 23.10s/it]claude-sonnet-4-20250514 zero-shot:   6%|▌         | 6/100 [02:17<34:32, 22.05s/it]claude-sonnet-4-20250514 zero-shot:   7%|▋         | 7/100 [02:39<33:59, 21.93s/it]claude-sonnet-4-20250514 zero-shot:   8%|▊         | 8/100 [03:06<36:13, 23.62s/it]claude-sonnet-4-20250514 zero-shot:   9%|▉         | 9/100 [03:28<34:58, 23.06s/it]claude-sonnet-4-20250514 zero-shot:  10%|█         | 10/100 [03:51<34:42, 23.14s/it]claude-sonnet-4-20250514 zero-shot:  11%|█         | 11/100 [04:13<33:52, 22.84s/it]claude-sonnet-4-20250514 zero-shot:  12%|█▏        | 12/100 [04:36<33:33, 22.89s/it]claude-sonnet-4-20250514 zero-shot:  13%|█▎        | 13/100 [04:58<32:33, 22.46s/it]claude-sonnet-4-20250514 zero-shot:  14%|█▍        | 14/100 [05:19<31:50, 22.21s/it]claude-sonnet-4-20250514 zero-shot:  15%|█▌        | 15/100 [05:41<31:15, 22.06s/it]claude-sonnet-4-20250514 zero-shot:  16%|█▌        | 16/100 [06:04<31:23, 22.42s/it]claude-sonnet-4-20250514 zero-shot:  17%|█▋        | 17/100 [06:28<31:24, 22.71s/it]claude-sonnet-4-20250514 zero-shot:  18%|█▊        | 18/100 [07:12<39:47, 29.12s/it]claude-sonnet-4-20250514 zero-shot:  19%|█▉        | 19/100 [07:35<36:50, 27.29s/it]claude-sonnet-4-20250514 zero-shot:  20%|██        | 20/100 [08:02<36:22, 27.28s/it]claude-sonnet-4-20250514 zero-shot:  21%|██        | 21/100 [08:24<33:41, 25.58s/it]claude-sonnet-4-20250514 zero-shot:  22%|██▏       | 22/100 [08:48<32:56, 25.34s/it]claude-sonnet-4-20250514 zero-shot:  23%|██▎       | 23/100 [09:09<30:53, 24.07s/it]claude-sonnet-4-20250514 zero-shot:  24%|██▍       | 24/100 [09:32<29:45, 23.50s/it]claude-sonnet-4-20250514 zero-shot:  25%|██▌       | 25/100 [09:53<28:27, 22.77s/it]claude-sonnet-4-20250514 zero-shot:  26%|██▌       | 26/100 [10:14<27:36, 22.38s/it]claude-sonnet-4-20250514 zero-shot:  27%|██▋       | 27/100 [10:36<27:09, 22.32s/it]claude-sonnet-4-20250514 zero-shot:  28%|██▊       | 28/100 [10:58<26:41, 22.24s/it]claude-sonnet-4-20250514 zero-shot:  29%|██▉       | 29/100 [11:19<25:44, 21.75s/it]claude-sonnet-4-20250514 zero-shot:  30%|███       | 30/100 [11:47<27:26, 23.52s/it]claude-sonnet-4-20250514 zero-shot:  31%|███       | 31/100 [12:07<25:57, 22.57s/it]claude-sonnet-4-20250514 zero-shot:  32%|███▏      | 32/100 [12:29<25:17, 22.32s/it]claude-sonnet-4-20250514 zero-shot:  33%|███▎      | 33/100 [12:51<24:58, 22.36s/it]claude-sonnet-4-20250514 zero-shot:  34%|███▍      | 34/100 [13:13<24:14, 22.04s/it]claude-sonnet-4-20250514 zero-shot:  35%|███▌      | 35/100 [13:34<23:47, 21.97s/it]claude-sonnet-4-20250514 zero-shot:  36%|███▌      | 36/100 [13:55<22:58, 21.54s/it]claude-sonnet-4-20250514 zero-shot:  37%|███▋      | 37/100 [14:15<22:17, 21.23s/it]claude-sonnet-4-20250514 zero-shot:  38%|███▊      | 38/100 [14:38<22:23, 21.67s/it]claude-sonnet-4-20250514 zero-shot:  39%|███▉      | 39/100 [15:02<22:36, 22.23s/it]claude-sonnet-4-20250514 zero-shot:  40%|████      | 40/100 [15:23<22:05, 22.09s/it]claude-sonnet-4-20250514 zero-shot:  41%|████      | 41/100 [15:45<21:29, 21.85s/it]claude-sonnet-4-20250514 zero-shot:  42%|████▏     | 42/100 [16:07<21:19, 22.06s/it]claude-sonnet-4-20250514 zero-shot:  43%|████▎     | 43/100 [16:29<20:49, 21.92s/it]claude-sonnet-4-20250514 zero-shot:  44%|████▍     | 44/100 [16:51<20:37, 22.10s/it]claude-sonnet-4-20250514 zero-shot:  45%|████▌     | 45/100 [17:15<20:41, 22.58s/it]claude-sonnet-4-20250514 zero-shot:  46%|████▌     | 46/100 [17:39<20:39, 22.95s/it]claude-sonnet-4-20250514 zero-shot:  47%|████▋     | 47/100 [18:02<20:18, 23.00s/it]claude-sonnet-4-20250514 zero-shot:  48%|████▊     | 48/100 [18:24<19:35, 22.61s/it]claude-sonnet-4-20250514 zero-shot:  49%|████▉     | 49/100 [18:45<18:51, 22.19s/it]claude-sonnet-4-20250514 zero-shot:  50%|█████     | 50/100 [19:07<18:27, 22.15s/it]claude-sonnet-4-20250514 zero-shot:  51%|█████     | 51/100 [19:29<18:01, 22.08s/it]claude-sonnet-4-20250514 zero-shot:  52%|█████▏    | 52/100 [19:50<17:32, 21.93s/it]claude-sonnet-4-20250514 zero-shot:  53%|█████▎    | 53/100 [20:14<17:32, 22.39s/it]claude-sonnet-4-20250514 zero-shot:  54%|█████▍    | 54/100 [20:36<17:07, 22.34s/it]claude-sonnet-4-20250514 zero-shot:  55%|█████▌    | 55/100 [20:57<16:27, 21.94s/it]claude-sonnet-4-20250514 zero-shot:  56%|█████▌    | 56/100 [21:18<15:54, 21.70s/it]claude-sonnet-4-20250514 zero-shot:  57%|█████▋    | 57/100 [21:42<16:03, 22.41s/it]claude-sonnet-4-20250514 zero-shot:  58%|█████▊    | 58/100 [22:04<15:36, 22.30s/it]claude-sonnet-4-20250514 zero-shot:  59%|█████▉    | 59/100 [22:24<14:41, 21.49s/it]claude-sonnet-4-20250514 zero-shot:  60%|██████    | 60/100 [22:47<14:42, 22.06s/it]claude-sonnet-4-20250514 zero-shot:  61%|██████    | 61/100 [23:09<14:16, 21.97s/it]claude-sonnet-4-20250514 zero-shot:  62%|██████▏   | 62/100 [23:30<13:38, 21.53s/it]claude-sonnet-4-20250514 zero-shot:  63%|██████▎   | 63/100 [23:51<13:12, 21.43s/it]claude-sonnet-4-20250514 zero-shot:  64%|██████▍   | 64/100 [24:16<13:34, 22.63s/it]claude-sonnet-4-20250514 zero-shot:  65%|██████▌   | 65/100 [24:37<12:49, 21.99s/it]claude-sonnet-4-20250514 zero-shot:  66%|██████▌   | 66/100 [24:58<12:20, 21.78s/it]claude-sonnet-4-20250514 zero-shot:  67%|██████▋   | 67/100 [25:20<11:56, 21.72s/it]claude-sonnet-4-20250514 zero-shot:  68%|██████▊   | 68/100 [25:43<11:48, 22.15s/it]claude-sonnet-4-20250514 zero-shot:  69%|██████▉   | 69/100 [26:06<11:40, 22.61s/it]claude-sonnet-4-20250514 zero-shot:  70%|███████   | 70/100 [26:28<11:08, 22.29s/it]claude-sonnet-4-20250514 zero-shot:  71%|███████   | 71/100 [26:49<10:35, 21.90s/it]claude-sonnet-4-20250514 zero-shot:  72%|███████▏  | 72/100 [27:08<09:53, 21.18s/it]claude-sonnet-4-20250514 zero-shot:  73%|███████▎  | 73/100 [27:30<09:37, 21.41s/it]claude-sonnet-4-20250514 zero-shot:  74%|███████▍  | 74/100 [27:52<09:16, 21.39s/it]claude-sonnet-4-20250514 zero-shot:  75%|███████▌  | 75/100 [28:12<08:47, 21.08s/it]claude-sonnet-4-20250514 zero-shot:  76%|███████▌  | 76/100 [28:34<08:29, 21.24s/it]claude-sonnet-4-20250514 zero-shot:  77%|███████▋  | 77/100 [28:54<08:03, 21.02s/it]claude-sonnet-4-20250514 zero-shot:  78%|███████▊  | 78/100 [29:16<07:46, 21.19s/it]claude-sonnet-4-20250514 zero-shot:  79%|███████▉  | 79/100 [29:39<07:38, 21.82s/it]claude-sonnet-4-20250514 zero-shot:  80%|████████  | 80/100 [29:59<07:05, 21.25s/it]claude-sonnet-4-20250514 zero-shot:  81%|████████  | 81/100 [30:22<06:56, 21.90s/it]claude-sonnet-4-20250514 zero-shot:  82%|████████▏ | 82/100 [30:44<06:31, 21.77s/it]claude-sonnet-4-20250514 zero-shot:  83%|████████▎ | 83/100 [31:04<05:59, 21.14s/it]claude-sonnet-4-20250514 zero-shot:  84%|████████▍ | 84/100 [31:25<05:37, 21.09s/it]claude-sonnet-4-20250514 zero-shot:  85%|████████▌ | 85/100 [31:44<05:10, 20.71s/it]claude-sonnet-4-20250514 zero-shot:  86%|████████▌ | 86/100 [32:06<04:55, 21.10s/it]claude-sonnet-4-20250514 zero-shot:  87%|████████▋ | 87/100 [32:28<04:36, 21.28s/it]claude-sonnet-4-20250514 zero-shot:  88%|████████▊ | 88/100 [32:49<04:12, 21.08s/it]claude-sonnet-4-20250514 zero-shot:  89%|████████▉ | 89/100 [33:09<03:48, 20.82s/it]claude-sonnet-4-20250514 zero-shot:  90%|█████████ | 90/100 [33:28<03:24, 20.44s/it]claude-sonnet-4-20250514 zero-shot:  91%|█████████ | 91/100 [33:51<03:08, 20.93s/it]claude-sonnet-4-20250514 zero-shot:  92%|█████████▏| 92/100 [34:11<02:45, 20.64s/it]claude-sonnet-4-20250514 zero-shot:  93%|█████████▎| 93/100 [34:33<02:27, 21.10s/it]claude-sonnet-4-20250514 zero-shot:  94%|█████████▍| 94/100 [34:54<02:06, 21.11s/it]claude-sonnet-4-20250514 zero-shot:  95%|█████████▌| 95/100 [35:14<01:43, 20.70s/it]claude-sonnet-4-20250514 zero-shot:  96%|█████████▌| 96/100 [35:36<01:24, 21.16s/it]claude-sonnet-4-20250514 zero-shot:  97%|█████████▋| 97/100 [35:56<01:02, 20.92s/it]claude-sonnet-4-20250514 zero-shot:  98%|█████████▊| 98/100 [36:18<00:42, 21.23s/it]claude-sonnet-4-20250514 zero-shot:  99%|█████████▉| 99/100 [36:39<00:21, 21.15s/it]claude-sonnet-4-20250514 zero-shot: 100%|██████████| 100/100 [37:08<00:00, 23.34s/it]claude-sonnet-4-20250514 zero-shot: 100%|██████████| 100/100 [37:08<00:00, 22.28s/it]

Model: claude-sonnet-4-20250514 | Prompt: zero_shot | Split: train | Examples used: 100
ID  Label                     TP   FN   TN   FP   Pres  Abs   Tot   PresenceAcc   Hit@Pt|Pres   gTP  gFN  gTN  gFP   GatedAcc
 1  Abdominal Wall             97    0    0    3     97    3   100    97.00%     14.43%    14   83    3    0    17.00%
 2  Liver                     100    0    0    0    100    0   100   100.00%     21.00%    21   79    0    0    21.00%
 3  Gastrointestinal Tract     80    0    0   20     80   20   100    80.00%      2.50%     2   78   20    0    22.00%
 4  Fat                       100    0    0    0    100    0   100   100.00%     35.00%    35   65    0    0    35.00%
 5  Grasper                    65    2   30    3     67   33   100    95.00%      8.96%     6   61   33    0    39.00%
 6  Connective Tissue          67    0    0   33     67   33   100    67.00%     47.76%    32   35   33    0    65.00%
 7  Blood                      34    0    0   66     34   66   100    34.00%      0.00%     0   34   66    0    66.00%
 8  Cystic Duct                21   13   15   51     34   66   100    36.00%     23.53%     8   26   66    0    74.00%
 9  L-hook Electrocautery      38    1   37   24     39   61   100    75.00%     20.51%     8   31   61    0    69.00%
10  Gallbladder                67    0    0   33     67   33   100    67.00%     16.42%    11   56   33    0    44.00%
11  Hepatic Vein                8   25   64    3     33   67   100    72.00%      0.00%     0   33   67    0    67.00%
12  Liver Ligament             33    0    0   67     33   67   100    33.00%      6.06%     2   31   67    0    69.00%

Totals across organs:
TP=710  FN=41  TN=146  FP=303  Present=751  Absent=449  Total=1200
Macro PresenceAcc= 71.33%   Macro Hit@Point|Present= 16.35%   Macro GatedAcc= 49.00%   Macro F1= 74.65%

🔄 Running few-shot (standard) with claude-sonnet-4-20250514 (enhanced metrics)...
claude-sonnet-4-20250514 standard:   0%|          | 0/100 [00:00<?, ?it/s]claude-sonnet-4-20250514 standard:   1%|          | 1/100 [01:08<1:53:31, 68.80s/it]claude-sonnet-4-20250514 standard:   2%|▏         | 2/100 [01:32<1:08:53, 42.17s/it]claude-sonnet-4-20250514 standard:   3%|▎         | 3/100 [01:56<55:10, 34.13s/it]  claude-sonnet-4-20250514 standard:   4%|▍         | 4/100 [02:22<49:13, 30.76s/it]claude-sonnet-4-20250514 standard:   5%|▌         | 5/100 [02:47<45:32, 28.77s/it]claude-sonnet-4-20250514 standard:   6%|▌         | 6/100 [03:10<41:41, 26.61s/it]claude-sonnet-4-20250514 standard:   7%|▋         | 7/100 [03:34<39:59, 25.81s/it]claude-sonnet-4-20250514 standard:   8%|▊         | 8/100 [03:58<38:40, 25.23s/it]claude-sonnet-4-20250514 standard:   9%|▉         | 9/100 [04:22<37:34, 24.77s/it]claude-sonnet-4-20250514 standard:  10%|█         | 10/100 [04:46<37:12, 24.81s/it]claude-sonnet-4-20250514 standard:  11%|█         | 11/100 [05:10<36:25, 24.56s/it]claude-sonnet-4-20250514 standard:  12%|█▏        | 12/100 [05:35<36:10, 24.66s/it]claude-sonnet-4-20250514 standard:  13%|█▎        | 13/100 [05:59<35:17, 24.33s/it]claude-sonnet-4-20250514 standard:  14%|█▍        | 14/100 [06:22<34:08, 23.82s/it]claude-sonnet-4-20250514 standard:  15%|█▌        | 15/100 [06:45<33:44, 23.82s/it]claude-sonnet-4-20250514 standard:  16%|█▌        | 16/100 [07:10<33:51, 24.18s/it]claude-sonnet-4-20250514 standard:  17%|█▋        | 17/100 [07:34<33:02, 23.88s/it]claude-sonnet-4-20250514 standard:  18%|█▊        | 18/100 [08:01<33:54, 24.81s/it]claude-sonnet-4-20250514 standard:  19%|█▉        | 19/100 [08:26<33:36, 24.89s/it]claude-sonnet-4-20250514 standard:  20%|██        | 20/100 [08:50<32:55, 24.69s/it]claude-sonnet-4-20250514 standard:  21%|██        | 21/100 [09:17<33:25, 25.39s/it]claude-sonnet-4-20250514 standard:  22%|██▏       | 22/100 [09:44<33:39, 25.90s/it]claude-sonnet-4-20250514 standard:  23%|██▎       | 23/100 [10:08<32:37, 25.43s/it]claude-sonnet-4-20250514 standard:  24%|██▍       | 24/100 [10:32<31:23, 24.79s/it]claude-sonnet-4-20250514 standard:  25%|██▌       | 25/100 [10:56<30:49, 24.66s/it]claude-sonnet-4-20250514 standard:  26%|██▌       | 26/100 [12:16<51:02, 41.39s/it]claude-sonnet-4-20250514 standard:  27%|██▋       | 27/100 [12:39<43:35, 35.83s/it]claude-sonnet-4-20250514 standard:  28%|██▊       | 28/100 [13:03<38:32, 32.12s/it]claude-sonnet-4-20250514 standard:  29%|██▉       | 29/100 [14:13<51:43, 43.72s/it]claude-sonnet-4-20250514 standard:  30%|███       | 30/100 [14:38<44:17, 37.97s/it]claude-sonnet-4-20250514 standard:  31%|███       | 31/100 [15:02<38:46, 33.71s/it]claude-sonnet-4-20250514 standard:  32%|███▏      | 32/100 [15:26<34:49, 30.73s/it]claude-sonnet-4-20250514 standard:  33%|███▎      | 33/100 [15:49<31:52, 28.55s/it]claude-sonnet-4-20250514 standard:  34%|███▍      | 34/100 [16:22<32:46, 29.80s/it]claude-sonnet-4-20250514 standard:  35%|███▌      | 35/100 [16:43<29:39, 27.38s/it]claude-sonnet-4-20250514 standard:  36%|███▌      | 36/100 [17:07<28:06, 26.35s/it]claude-sonnet-4-20250514 standard:  37%|███▋      | 37/100 [17:30<26:22, 25.13s/it]claude-sonnet-4-20250514 standard:  38%|███▊      | 38/100 [17:53<25:20, 24.52s/it]claude-sonnet-4-20250514 standard:  39%|███▉      | 39/100 [18:16<24:30, 24.11s/it]claude-sonnet-4-20250514 standard:  40%|████      | 40/100 [18:40<24:01, 24.03s/it]claude-sonnet-4-20250514 standard:  41%|████      | 41/100 [19:04<23:46, 24.17s/it]claude-sonnet-4-20250514 standard:  42%|████▏     | 42/100 [19:29<23:36, 24.43s/it]claude-sonnet-4-20250514 standard:  43%|████▎     | 43/100 [19:52<22:46, 23.98s/it]claude-sonnet-4-20250514 standard:  44%|████▍     | 44/100 [20:14<21:48, 23.36s/it]claude-sonnet-4-20250514 standard:  45%|████▌     | 45/100 [20:38<21:33, 23.52s/it]claude-sonnet-4-20250514 standard:  46%|████▌     | 46/100 [21:02<21:08, 23.49s/it]claude-sonnet-4-20250514 standard:  47%|████▋     | 47/100 [21:25<20:52, 23.64s/it]claude-sonnet-4-20250514 standard:  48%|████▊     | 48/100 [21:49<20:27, 23.61s/it]claude-sonnet-4-20250514 standard:  49%|████▉     | 49/100 [22:12<19:54, 23.43s/it]claude-sonnet-4-20250514 standard:  50%|█████     | 50/100 [22:34<19:15, 23.11s/it]claude-sonnet-4-20250514 standard:  51%|█████     | 51/100 [22:57<18:51, 23.10s/it]claude-sonnet-4-20250514 standard:  52%|█████▏    | 52/100 [26:23<1:02:11, 77.74s/it]claude-sonnet-4-20250514 standard:  53%|█████▎    | 53/100 [26:48<48:27, 61.86s/it]  claude-sonnet-4-20250514 standard:  54%|█████▍    | 54/100 [27:11<38:29, 50.20s/it]claude-sonnet-4-20250514 standard:  55%|█████▌    | 55/100 [27:35<31:47, 42.40s/it]claude-sonnet-4-20250514 standard:  56%|█████▌    | 56/100 [28:01<27:34, 37.61s/it]claude-sonnet-4-20250514 standard:  57%|█████▋    | 57/100 [28:26<24:15, 33.86s/it]claude-sonnet-4-20250514 standard:  58%|█████▊    | 58/100 [28:52<21:55, 31.32s/it]claude-sonnet-4-20250514 standard:  59%|█████▉    | 59/100 [29:16<20:01, 29.31s/it]claude-sonnet-4-20250514 standard:  60%|██████    | 60/100 [29:40<18:27, 27.68s/it]claude-sonnet-4-20250514 standard:  61%|██████    | 61/100 [30:07<17:52, 27.51s/it]claude-sonnet-4-20250514 standard:  62%|██████▏   | 62/100 [30:32<16:56, 26.75s/it]claude-sonnet-4-20250514 standard:  63%|██████▎   | 63/100 [31:01<16:54, 27.41s/it]claude-sonnet-4-20250514 standard:  64%|██████▍   | 64/100 [31:26<16:01, 26.71s/it]claude-sonnet-4-20250514 standard:  65%|██████▌   | 65/100 [32:17<19:48, 33.97s/it]claude-sonnet-4-20250514 standard:  66%|██████▌   | 66/100 [32:42<17:37, 31.10s/it]claude-sonnet-4-20250514 standard:  67%|██████▋   | 67/100 [33:06<16:02, 29.17s/it]claude-sonnet-4-20250514 standard:  68%|██████▊   | 68/100 [33:38<15:57, 29.92s/it]claude-sonnet-4-20250514 standard:  69%|██████▉   | 69/100 [35:08<24:47, 47.98s/it]claude-sonnet-4-20250514 standard:  70%|███████   | 70/100 [35:34<20:37, 41.25s/it]claude-sonnet-4-20250514 standard:  71%|███████   | 71/100 [36:15<19:58, 41.33s/it]claude-sonnet-4-20250514 standard:  72%|███████▏  | 72/100 [36:41<17:06, 36.67s/it]claude-sonnet-4-20250514 standard:  73%|███████▎  | 73/100 [38:44<28:09, 62.59s/it]claude-sonnet-4-20250514 standard:  74%|███████▍  | 74/100 [39:08<22:07, 51.04s/it]claude-sonnet-4-20250514 standard:  75%|███████▌  | 75/100 [39:31<17:47, 42.70s/it]claude-sonnet-4-20250514 standard:  76%|███████▌  | 76/100 [42:20<32:08, 80.36s/it]claude-sonnet-4-20250514 standard:  77%|███████▋  | 77/100 [42:45<24:27, 63.80s/it]claude-sonnet-4-20250514 standard:  78%|███████▊  | 78/100 [43:09<19:05, 52.05s/it]claude-sonnet-4-20250514 standard:  79%|███████▉  | 79/100 [43:35<15:26, 44.14s/it]claude-sonnet-4-20250514 standard:  80%|████████  | 80/100 [44:02<13:01, 39.06s/it]claude-sonnet-4-20250514 standard:  81%|████████  | 81/100 [44:26<10:57, 34.59s/it]claude-sonnet-4-20250514 standard:  82%|████████▏ | 82/100 [44:52<09:34, 31.92s/it]claude-sonnet-4-20250514 standard:  83%|████████▎ | 83/100 [45:24<09:03, 31.97s/it]claude-sonnet-4-20250514 standard:  84%|████████▍ | 84/100 [45:48<07:52, 29.53s/it]claude-sonnet-4-20250514 standard:  85%|████████▌ | 85/100 [46:16<07:17, 29.19s/it]claude-sonnet-4-20250514 standard:  86%|████████▌ | 86/100 [46:44<06:43, 28.79s/it]claude-sonnet-4-20250514 standard:  87%|████████▋ | 87/100 [47:09<05:59, 27.66s/it]claude-sonnet-4-20250514 standard:  88%|████████▊ | 88/100 [47:34<05:22, 26.88s/it]claude-sonnet-4-20250514 standard:  89%|████████▉ | 89/100 [47:59<04:49, 26.34s/it]claude-sonnet-4-20250514 standard:  90%|█████████ | 90/100 [48:24<04:18, 25.81s/it]claude-sonnet-4-20250514 standard:  91%|█████████ | 91/100 [48:49<03:50, 25.57s/it]claude-sonnet-4-20250514 standard:  92%|█████████▏| 92/100 [49:17<03:30, 26.28s/it]claude-sonnet-4-20250514 standard:  93%|█████████▎| 93/100 [49:42<03:00, 25.81s/it]claude-sonnet-4-20250514 standard:  94%|█████████▍| 94/100 [50:15<02:49, 28.18s/it]claude-sonnet-4-20250514 standard:  95%|█████████▌| 95/100 [50:42<02:18, 27.64s/it]claude-sonnet-4-20250514 standard:  96%|█████████▌| 96/100 [51:07<01:47, 26.91s/it]claude-sonnet-4-20250514 standard:  97%|█████████▋| 97/100 [51:34<01:20, 26.93s/it]claude-sonnet-4-20250514 standard:  98%|█████████▊| 98/100 [51:58<00:52, 26.04s/it]claude-sonnet-4-20250514 standard:  99%|█████████▉| 99/100 [52:24<00:25, 25.97s/it]claude-sonnet-4-20250514 standard: 100%|██████████| 100/100 [52:51<00:00, 26.25s/it]claude-sonnet-4-20250514 standard: 100%|██████████| 100/100 [52:51<00:00, 31.71s/it]
❌ Error calling Anthropic API for claude-sonnet-4-20250514: Error code: 499 - {'error': 'Client closed request'}
   Attempt 1/3
❌ Error calling Anthropic API for claude-sonnet-4-20250514: Error code: 499 - {'error': 'Client closed request'}
   Attempt 1/3

Model: claude-sonnet-4-20250514 | Prompt: fewshot_standard | Split: train | Examples used: 100
ID  Label                     TP   FN   TN   FP   Pres  Abs   Tot   PresenceAcc   Hit@Pt|Pres   gTP  gFN  gTN  gFP   GatedAcc
 1  Abdominal Wall             93    4    0    3     97    3   100    93.00%     22.68%    22   75    3    0    25.00%
 2  Liver                     100    0    0    0    100    0   100   100.00%     30.00%    30   70    0    0    30.00%
 3  Gastrointestinal Tract     70   10    1   19     80   20   100    71.00%      0.00%     0   80   20    0    20.00%
 4  Fat                       100    0    0    0    100    0   100   100.00%     49.00%    49   51    0    0    49.00%
 5  Grasper                    65    2   33    0     67   33   100    98.00%     14.93%    10   57   33    0    43.00%
 6  Connective Tissue          67    0    0   33     67   33   100    67.00%     70.15%    47   20   33    0    80.00%
 7  Blood                      34    0   38   28     34   66   100    72.00%      2.94%     1   33   66    0    67.00%
 8  Cystic Duct                34    0   29   37     34   66   100    63.00%      8.82%     3   31   66    0    69.00%
 9  L-hook Electrocautery      24   15   47   14     39   61   100    71.00%      7.69%     3   36   61    0    64.00%
10  Gallbladder                62    5   31    2     67   33   100    93.00%     20.90%    14   53   33    0    47.00%
11  Hepatic Vein               33    0   67    0     33   67   100   100.00%      0.00%     0   33   67    0    67.00%
12  Liver Ligament             27    6   38   29     33   67   100    65.00%      3.03%     1   32   67    0    68.00%

Totals across organs:
TP=709  FN=42  TN=284  FP=165  Present=751  Absent=449  Total=1200
Macro PresenceAcc= 82.75%   Macro Hit@Point|Present= 19.18%   Macro GatedAcc= 52.42%   Macro F1= 84.27%

🔄 Running few-shot (hard_negatives) with claude-sonnet-4-20250514 (enhanced metrics)...
claude-sonnet-4-20250514 hard_negatives:   0%|          | 0/100 [00:00<?, ?it/s]claude-sonnet-4-20250514 hard_negatives:   1%|          | 1/100 [00:24<40:56, 24.81s/it]claude-sonnet-4-20250514 hard_negatives:   2%|▏         | 2/100 [00:47<38:53, 23.81s/it]claude-sonnet-4-20250514 hard_negatives:   3%|▎         | 3/100 [01:12<39:16, 24.30s/it]claude-sonnet-4-20250514 hard_negatives:   4%|▍         | 4/100 [01:36<38:34, 24.11s/it]claude-sonnet-4-20250514 hard_negatives:   5%|▌         | 5/100 [02:00<38:02, 24.03s/it]claude-sonnet-4-20250514 hard_negatives:   6%|▌         | 6/100 [02:24<37:44, 24.10s/it]claude-sonnet-4-20250514 hard_negatives:   7%|▋         | 7/100 [02:48<37:25, 24.14s/it]claude-sonnet-4-20250514 hard_negatives:   8%|▊         | 8/100 [03:13<37:04, 24.18s/it]claude-sonnet-4-20250514 hard_negatives:   9%|▉         | 9/100 [03:39<37:40, 24.84s/it]claude-sonnet-4-20250514 hard_negatives:  10%|█         | 10/100 [04:03<37:00, 24.67s/it]claude-sonnet-4-20250514 hard_negatives:  11%|█         | 11/100 [04:27<36:19, 24.49s/it]claude-sonnet-4-20250514 hard_negatives:  12%|█▏        | 12/100 [04:50<35:13, 24.02s/it]claude-sonnet-4-20250514 hard_negatives:  13%|█▎        | 13/100 [05:14<34:34, 23.85s/it]claude-sonnet-4-20250514 hard_negatives:  14%|█▍        | 14/100 [05:38<34:27, 24.05s/it]claude-sonnet-4-20250514 hard_negatives:  15%|█▌        | 15/100 [06:04<34:52, 24.62s/it]claude-sonnet-4-20250514 hard_negatives:  16%|█▌        | 16/100 [06:33<36:10, 25.84s/it]claude-sonnet-4-20250514 hard_negatives:  17%|█▋        | 17/100 [06:56<34:25, 24.89s/it]claude-sonnet-4-20250514 hard_negatives:  18%|█▊        | 18/100 [07:20<33:55, 24.82s/it]claude-sonnet-4-20250514 hard_negatives:  19%|█▉        | 19/100 [07:45<33:32, 24.85s/it]claude-sonnet-4-20250514 hard_negatives:  20%|██        | 20/100 [08:10<33:03, 24.79s/it]claude-sonnet-4-20250514 hard_negatives:  21%|██        | 21/100 [08:34<32:19, 24.55s/it]claude-sonnet-4-20250514 hard_negatives:  22%|██▏       | 22/100 [08:58<31:38, 24.34s/it]claude-sonnet-4-20250514 hard_negatives:  23%|██▎       | 23/100 [09:24<31:54, 24.86s/it]claude-sonnet-4-20250514 hard_negatives:  24%|██▍       | 24/100 [09:50<31:58, 25.24s/it]claude-sonnet-4-20250514 hard_negatives:  25%|██▌       | 25/100 [10:14<31:01, 24.82s/it]claude-sonnet-4-20250514 hard_negatives:  26%|██▌       | 26/100 [10:36<29:46, 24.14s/it]claude-sonnet-4-20250514 hard_negatives:  27%|██▋       | 27/100 [11:04<30:40, 25.21s/it]claude-sonnet-4-20250514 hard_negatives:  28%|██▊       | 28/100 [11:26<29:13, 24.35s/it]claude-sonnet-4-20250514 hard_negatives:  29%|██▉       | 29/100 [11:50<28:38, 24.21s/it]claude-sonnet-4-20250514 hard_negatives:  30%|███       | 30/100 [12:15<28:17, 24.24s/it]claude-sonnet-4-20250514 hard_negatives:  31%|███       | 31/100 [12:42<29:03, 25.27s/it]claude-sonnet-4-20250514 hard_negatives:  32%|███▏      | 32/100 [13:06<28:05, 24.79s/it]claude-sonnet-4-20250514 hard_negatives:  33%|███▎      | 33/100 [13:30<27:32, 24.66s/it]claude-sonnet-4-20250514 hard_negatives:  34%|███▍      | 34/100 [13:53<26:32, 24.13s/it]claude-sonnet-4-20250514 hard_negatives:  35%|███▌      | 35/100 [14:16<25:51, 23.87s/it]claude-sonnet-4-20250514 hard_negatives:  36%|███▌      | 36/100 [14:43<26:25, 24.77s/it]claude-sonnet-4-20250514 hard_negatives:  37%|███▋      | 37/100 [15:05<25:12, 24.00s/it]claude-sonnet-4-20250514 hard_negatives:  38%|███▊      | 38/100 [15:33<25:49, 24.99s/it]claude-sonnet-4-20250514 hard_negatives:  39%|███▉      | 39/100 [15:55<24:38, 24.25s/it]claude-sonnet-4-20250514 hard_negatives:  40%|████      | 40/100 [16:19<24:03, 24.05s/it]claude-sonnet-4-20250514 hard_negatives:  41%|████      | 41/100 [16:43<23:42, 24.12s/it]claude-sonnet-4-20250514 hard_negatives:  42%|████▏     | 42/100 [17:12<24:33, 25.41s/it]claude-sonnet-4-20250514 hard_negatives:  43%|████▎     | 43/100 [17:38<24:21, 25.64s/it]claude-sonnet-4-20250514 hard_negatives:  44%|████▍     | 44/100 [18:02<23:32, 25.22s/it]claude-sonnet-4-20250514 hard_negatives:  45%|████▌     | 45/100 [18:26<22:52, 24.96s/it]claude-sonnet-4-20250514 hard_negatives:  46%|████▌     | 46/100 [19:01<25:06, 27.91s/it]claude-sonnet-4-20250514 hard_negatives:  47%|████▋     | 47/100 [19:24<23:22, 26.46s/it]claude-sonnet-4-20250514 hard_negatives:  48%|████▊     | 48/100 [19:48<22:06, 25.52s/it]claude-sonnet-4-20250514 hard_negatives:  49%|████▉     | 49/100 [20:12<21:27, 25.24s/it]claude-sonnet-4-20250514 hard_negatives:  50%|█████     | 50/100 [20:36<20:45, 24.91s/it]claude-sonnet-4-20250514 hard_negatives:  51%|█████     | 51/100 [20:59<19:55, 24.40s/it]claude-sonnet-4-20250514 hard_negatives:  52%|█████▏    | 52/100 [22:22<33:32, 41.93s/it]claude-sonnet-4-20250514 hard_negatives:  53%|█████▎    | 53/100 [22:46<28:34, 36.47s/it]claude-sonnet-4-20250514 hard_negatives:  54%|█████▍    | 54/100 [23:11<25:16, 32.98s/it]claude-sonnet-4-20250514 hard_negatives:  55%|█████▌    | 55/100 [23:35<22:40, 30.23s/it]claude-sonnet-4-20250514 hard_negatives:  56%|█████▌    | 56/100 [23:57<20:25, 27.86s/it]claude-sonnet-4-20250514 hard_negatives:  57%|█████▋    | 57/100 [24:21<19:12, 26.81s/it]claude-sonnet-4-20250514 hard_negatives:  58%|█████▊    | 58/100 [24:48<18:44, 26.78s/it]claude-sonnet-4-20250514 hard_negatives:  59%|█████▉    | 59/100 [25:14<18:03, 26.44s/it]claude-sonnet-4-20250514 hard_negatives:  60%|██████    | 60/100 [25:38<17:08, 25.70s/it]claude-sonnet-4-20250514 hard_negatives:  61%|██████    | 61/100 [26:02<16:30, 25.40s/it]claude-sonnet-4-20250514 hard_negatives:  62%|██████▏   | 62/100 [26:25<15:37, 24.67s/it]claude-sonnet-4-20250514 hard_negatives:  63%|██████▎   | 63/100 [26:50<15:14, 24.72s/it]claude-sonnet-4-20250514 hard_negatives:  64%|██████▍   | 64/100 [27:14<14:41, 24.48s/it]claude-sonnet-4-20250514 hard_negatives:  65%|██████▌   | 65/100 [27:37<13:58, 23.97s/it]claude-sonnet-4-20250514 hard_negatives:  66%|██████▌   | 66/100 [28:02<13:47, 24.33s/it]claude-sonnet-4-20250514 hard_negatives:  67%|██████▋   | 67/100 [28:26<13:16, 24.13s/it]claude-sonnet-4-20250514 hard_negatives:  68%|██████▊   | 68/100 [28:50<12:55, 24.24s/it]claude-sonnet-4-20250514 hard_negatives:  69%|██████▉   | 69/100 [29:14<12:27, 24.12s/it]claude-sonnet-4-20250514 hard_negatives:  70%|███████   | 70/100 [30:10<16:51, 33.72s/it]claude-sonnet-4-20250514 hard_negatives:  71%|███████   | 71/100 [30:34<14:49, 30.68s/it]claude-sonnet-4-20250514 hard_negatives:  72%|███████▏  | 72/100 [30:56<13:06, 28.08s/it]claude-sonnet-4-20250514 hard_negatives:  73%|███████▎  | 73/100 [31:17<11:45, 26.14s/it]claude-sonnet-4-20250514 hard_negatives:  74%|███████▍  | 74/100 [31:42<11:07, 25.69s/it]claude-sonnet-4-20250514 hard_negatives:  75%|███████▌  | 75/100 [32:04<10:16, 24.65s/it]claude-sonnet-4-20250514 hard_negatives:  76%|███████▌  | 76/100 [32:28<09:48, 24.51s/it]claude-sonnet-4-20250514 hard_negatives:  77%|███████▋  | 77/100 [36:03<31:14, 81.50s/it]claude-sonnet-4-20250514 hard_negatives:  78%|███████▊  | 78/100 [46:27<1:29:37, 244.42s/it]claude-sonnet-4-20250514 hard_negatives:  79%|███████▉  | 79/100 [49:14<1:17:21, 221.01s/it]claude-sonnet-4-20250514 hard_negatives:  80%|████████  | 80/100 [49:38<54:00, 162.03s/it]  claude-sonnet-4-20250514 hard_negatives:  81%|████████  | 81/100 [50:04<38:22, 121.19s/it]claude-sonnet-4-20250514 hard_negatives:  82%|████████▏ | 82/100 [50:26<27:25, 91.40s/it] claude-sonnet-4-20250514 hard_negatives:  83%|████████▎ | 83/100 [50:49<20:02, 70.75s/it]claude-sonnet-4-20250514 hard_negatives:  84%|████████▍ | 84/100 [51:17<15:29, 58.10s/it]claude-sonnet-4-20250514 hard_negatives:  85%|████████▌ | 85/100 [51:42<12:00, 48.04s/it]claude-sonnet-4-20250514 hard_negatives:  86%|████████▌ | 86/100 [52:06<09:33, 40.98s/it]claude-sonnet-4-20250514 hard_negatives:  87%|████████▋ | 87/100 [52:29<07:42, 35.60s/it]claude-sonnet-4-20250514 hard_negatives:  88%|████████▊ | 88/100 [53:05<07:09, 35.76s/it]claude-sonnet-4-20250514 hard_negatives:  89%|████████▉ | 89/100 [53:32<06:01, 32.86s/it]claude-sonnet-4-20250514 hard_negatives:  90%|█████████ | 90/100 [53:56<05:04, 30.47s/it]claude-sonnet-4-20250514 hard_negatives:  91%|█████████ | 91/100 [54:19<04:13, 28.22s/it]claude-sonnet-4-20250514 hard_negatives:  92%|█████████▏| 92/100 [54:48<03:45, 28.22s/it]claude-sonnet-4-20250514 hard_negatives:  93%|█████████▎| 93/100 [55:11<03:06, 26.66s/it]claude-sonnet-4-20250514 hard_negatives:  94%|█████████▍| 94/100 [55:43<02:49, 28.28s/it]claude-sonnet-4-20250514 hard_negatives:  95%|█████████▌| 95/100 [56:07<02:14, 26.93s/it]claude-sonnet-4-20250514 hard_negatives:  96%|█████████▌| 96/100 [56:32<01:46, 26.51s/it]claude-sonnet-4-20250514 hard_negatives:  97%|█████████▋| 97/100 [56:57<01:18, 26.03s/it]claude-sonnet-4-20250514 hard_negatives:  98%|█████████▊| 98/100 [57:25<00:53, 26.66s/it]claude-sonnet-4-20250514 hard_negatives:  99%|█████████▉| 99/100 [57:50<00:26, 26.16s/it]claude-sonnet-4-20250514 hard_negatives: 100%|██████████| 100/100 [58:18<00:00, 26.73s/it]claude-sonnet-4-20250514 hard_negatives: 100%|██████████| 100/100 [58:18<00:00, 34.99s/it]
❌ Error calling Anthropic API for claude-sonnet-4-20250514: Error code: 499 - {'error': 'Client closed request'}
   Attempt 1/3

Model: claude-sonnet-4-20250514 | Prompt: fewshot_hard_negatives | Split: train | Examples used: 100
ID  Label                     TP   FN   TN   FP   Pres  Abs   Tot   PresenceAcc   Hit@Pt|Pres   gTP  gFN  gTN  gFP   GatedAcc
 1  Abdominal Wall             95    2    0    3     97    3   100    95.00%     29.90%    29   68    3    0    32.00%
 2  Liver                     100    0    0    0    100    0   100   100.00%     25.00%    25   75    0    0    25.00%
 3  Gastrointestinal Tract     68   12    2   18     80   20   100    70.00%      0.00%     0   80   20    0    20.00%
 4  Fat                       100    0    0    0    100    0   100   100.00%     28.00%    28   72    0    0    28.00%
 5  Grasper                    61    6   33    0     67   33   100    94.00%      7.46%     5   62   33    0    38.00%
 6  Connective Tissue          67    0    0   33     67   33   100    67.00%     61.19%    41   26   33    0    74.00%
 7  Blood                      34    0   22   44     34   66   100    56.00%      5.88%     2   32   66    0    68.00%
 8  Cystic Duct                34    0   38   28     34   66   100    72.00%      5.88%     2   32   66    0    68.00%
 9  L-hook Electrocautery      22   17   48   13     39   61   100    70.00%      7.69%     3   36   61    0    64.00%
10  Gallbladder                49   18   33    0     67   33   100    82.00%     19.40%    13   54   33    0    46.00%
11  Hepatic Vein               33    0   66    1     33   67   100    99.00%      0.00%     0   33   67    0    67.00%
12  Liver Ligament             32    1   33   34     33   67   100    65.00%     12.12%     4   29   67    0    71.00%

Totals across organs:
TP=695  FN=56  TN=275  FP=174  Present=751  Absent=449  Total=1200
Macro PresenceAcc= 80.83%   Macro Hit@Point|Present= 16.88%   Macro GatedAcc= 50.08%   Macro F1= 82.80%

💾 Saved comparison table to ../results/pointing_original/metrics_comparison.txt
💾 Saved metrics JSON to ../results/pointing_original/metrics_comparison.json

✨ Evaluation complete!

============================================================
Final Summary
============================================================

claude-sonnet-4-20250514:
  zero_shot                 PresAcc: 0.713, GatedAcc: 0.490, Hit@Pt: 0.163, F1: 0.746
  few_shot_standard         PresAcc: 0.828, GatedAcc: 0.524, Hit@Pt: 0.192, F1: 0.843
  few_shot_hard_negatives   PresAcc: 0.808, GatedAcc: 0.501, Hit@Pt: 0.169, F1: 0.828

==========================================
Evaluation Complete!
==========================================
Pointing results: ../results/pointing_original/
  ✓ Metrics summary available
